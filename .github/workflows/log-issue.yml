name: Secure Issue Logger

on:
  workflow_dispatch:
    inputs:
      node:
        description: 'System Node'
        required: true
      issue:
        description: 'Issue Observed'
        required: true
      cause:
        description: 'Root Cause'
        required: false
      action:
        description: 'Remedial Action'
        required: false
      status:
        description: 'Status'
        required: false
        default: 'Open'
      comments:
        description: 'Comments'
        required: false
      tags:
        description: 'Tags (comma-separated)'
        required: false

jobs:
  log:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run logger container
        run: |
          docker run --rm \
            -e GITHUB_USER="${{ secrets.GITHUB_USER }}" \
            -e GITHUB_PAT="${{ secrets.GITHUB_PAT }}" \
            -e LOG_PW="${{ secrets.LOG_PW }}" \
            -e GIT_USER_NAME="${{ secrets.GIT_USER_NAME }}" \
            -e GIT_USER_EMAIL="${{ secrets.GIT_USER_EMAIL }}" \
            registry.digitalocean.com/system-issue-logger/logger:latest
        env:
          # pass the prompt inputs as environment so your entrypoint can read them
          DATE: ${{ github.event.inputs.date || '' }}
          NODE: ${{ github.event.inputs.node }}
          ISSUE: ${{ github.event.inputs.issue }}
          CAUSE: ${{ github.event.inputs.cause }}
          ACTION: ${{ github.event.inputs.action }}
          STATUS: ${{ github.event.inputs.status }}
          COMMENTS: ${{ github.event.inputs.comments }}
          TAGS: ${{ github.event.inputs.tags }}
